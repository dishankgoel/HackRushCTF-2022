from math import gcd
from binascii import unhexlify

e = 65537

def egcd(a, b):
    if a == 0:
        return (b, 0, 1)
    else:
        g, y, x = egcd(b%a, a)
        return (g, x - (b//a)*y, y)

def modinv(a, m):
    g, x, y = egcd(a, m)
    if(g != 1):
        return -1
    return x%m

def solve_rsa(factors, c):

    ds = []
    for i in range(len(factors)):
        ds.append(modinv(e, factors[i] - 1))

    m = factors[0]
    ts = []
    for i in range(1, len(factors)):
        ts.append(modinv(m, factors[i]))
        m = m*factors[i]
    xs = []
    for i in range(len(factors)):
        xs.append(pow((c%factors[i]), ds[i], factors[i]))

    x = xs[0]
    m = factors[0]

    for i in range(1, len(factors)):
        x += m*((xs[i] - x % factors[i]) * (ts[i - 1] % factors[i]))
        m = m*factors[i]

    print("[*] flag: {}".format(unhexlify(hex(x%m)[2:])))

n1 = 2569363537751848905613752123901931481193433076217778751179258097510039525799064954639842430393601847
n2 = 3104997489309511976553906663521571997419452300311061931307575141188192875050821260028125922552137357
n3 = 3578918446886232413385792472048736826730726813331131495442974103956807856267885952054576819564939287
n4 = 7178110893823137066502425713707191377417984426845457626775528500078058107681079019528401417950300867
n5 = 2768985075439759293722717041854973156268352764449377023790149913793621276659724661114040334001325383
n6 = 5884554620213049615277183064273676855125200515310973512539917890648225617560984680514483280119370209

c1 = 93267692564034911469197644294950748935556377193477555437947483049462781461499559715142553279919961
c2 = 1918295504592145685261220545912917886106438661015039338195088293647340316624730285409013194831369266
c3 = 270046004641771749071252334089463313667007272712436664986135213524031474831853823530088262436972924
c4 = 6120656195547749229995086755518882006575876895971903599673302655159967543051261323861977336785162190
c5 = 153573712183860953263390984200460830314705629635110100162425785211934234633270799448621081053861547
c6 = 1813557592827721817961440873181357174485780849640723795312547723574639922815550013768658150758612948

ns = [n1, n2, n3, n4, n5, n6]
cs = [c1, c2, c3, c4, c5, c6]

# Finding any common factor
for i in range(len(ns)):
    for j in range(len(ns)):
        ni, nj = ns[i], ns[j]
        if ni != nj and gcd(ni, nj) > 1:
            p = gcd(ni, nj)
            q = ni // p
            c = cs[i]
            factors = [p, q]
            solve_rsa(factors, c)
